!function(){"use strict";var a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var e=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t};var o=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t};var f=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(Object(n));"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(t){o(e,t,n[t])})}return e},h={CONTINUE:100,OK:200,INTERNAL_ERROR:400,ALREADY_PERSONALIZED:401,PASSWORD_MISMATCH:402,PASSWORD_LOCKOUT:403,WRONG_KEY:404,WRONG_KEY_SECOND:405,NOT_A_KEY:406,NOT_A_KEY_SECOND:407,KEY_DISABLED:408,NOT_ALLOWED:409,BLANK_TOKEN:410,BLANK_SECOND_TOKEN:411,ACTIVITY_PROFILE_LOCKED:412,SSL_REQUIRED:413,BLANK_NORMAL_TOKEN:414,BLANK_SECOND_NORMAL_TOKEN:415,BLANK_MASTER_TOKEN:416,BLANK_SECOND_MASTER_TOKEN:417,NOT_ACTIVATED_TOKEN:418,NOT_ACTIVATED_SECOND_TOKEN:419,WRONG_KEY_SET:420,NO_VERIFIER:421,INCOMPLETE_KEYSET:422,INVALID_TICKET:423,SAME_TOKEN:424,NO_RECOVERY_INFO:425,BAD_RECOVERY_REQUEST:426,RECOVERY_FAILED:427,TERMINAL_ERROR:500,TERMINAL_NOT_FOUND:501,TERMINAL_BAD_REQUEST:502,NO_CONNECTION:503,NETWORK_ERROR:504,PROTOCOL_ERROR:505,UNKNOWN_HANDLER:506,TERMINAL_CANCELED:590,TIMEOUT:600,TICKET_TIMEOUT:601,USER_REJECT:603,NO_AUTH_INTERFACES_FOUND:604,TERMINAL_TIMEOUT:605,UNSUPPORTED_PLATFORM:606},c="No WWPass SecurityPack is found on your computer or WWPass Browser Plugin is disabled",d=[],l=function(){for(;d.length;){var t=d.shift();t.readyState===WebSocket.OPEN&&t.close()}},p=function(t){return new Promise(function(n,r){var o=f({},{ppx:"wwp_",version:2,ticket:void 0,callbackURL:void 0,returnErrors:!1,log:function(){},development:!1,spfewsAddress:"wss://spfews.wwpass.com",echo:void 0},t),i=null,a=o.ticket,c=null,s=function(t,e){200===t?n({ppx:o.ppx,version:o.version,status:t,reason:"OK",ticket:o.ticket,callbackURL:o.callbackURL,clientKey:i,originalTicket:a,ttl:c}):r({ppx:o.ppx,version:o.version,status:t,reason:e,ticket:o.ticket,callbackURL:o.callbackURL})};if("WebSocket"in window){var e=o.spfewsAddress,u=new WebSocket(e);d.push(u);var l=o.log;u.onopen=function(){try{l("Connected: ".concat(e));var t=JSON.stringify({ticket:o.ticket});l("Sent message to server: ".concat(t)),u.send(t)}catch(t){l(t),s(h.INTERNAL_ERROR,"WebSocket error")}},u.onclose=function(){try{var t=d.indexOf(u);-1!==t&&d.splice(t,1),l("Disconnected"),n({refresh:!0})}catch(t){l(t),s(h.INTERNAL_ERROR,"WebSocket error")}},u.onmessage=function(t){try{l("Message received from server: ".concat(t.data));var e=JSON.parse(t.data),n=e.code,r=e.reason;if("clientKey"in e&&!i&&(i=e.clientKey,void 0!==e.originalTicket&&(a=e.originalTicket,c=e.ttl)),100===n)return;s(n,r),u.close()}catch(t){l(t),s(h.INTERNAL_ERROR,"WebSocket error")}}}else s(h.INTERNAL_ERROR,"WebSocket is not supported.")})},i=function(t){return btoa(String.fromCharCode.apply(null,new Uint8Array(t)))},s=function(t){for(var e=atob(t),n=new Uint8Array(e.length),r=0;r<e.length;r+=1)n[r]=e.charCodeAt(r);return n.buffer},n=function(t){return String.fromCharCode.apply(null,new Uint16Array(t))},u=function(t){for(var e=new ArrayBuffer(2*t.length),n=new Uint16Array(e),r=0,o=t.length;r<o;r+=1)n[r]=t.charCodeAt(r);return e},g=window.crypto||window.msCrypto,v=g?g.webkitSubtle||g.subtle:null,w=function(t){return i(t).replace(/\+/g,"-").replace(/[/]/g,".").replace(/=/g,"_")},y=function(t,e,n){return v.decrypt(t,e,n)},m=function(t,e,n,r,o){return v.importKey(t,e,n,r,o)};var E=function(t){if(Array.isArray(t))return t};var b=function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}};var R=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var _=function(t,e){return E(t)||b(t,e)||R()},T=function(t){var e=t.split("@"),n=_(e,1)[0].split(":");if(n.length<3)return!1;return n[1].split("").some(function(t){return"c"===t})},k=function(t){if(t&&t.data){var e={ticket:t.data,ttl:t.ttl||120};return delete e.data,e}return t};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var A=t(function(e){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(t){return typeof t}:e.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}e.exports=n});var N=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var C=function(t,e){return!e||"object"!==A(e)&&"function"!=typeof e?N(t):e},L=t(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n}),x=t(function(n){function r(t,e){return n.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}n.exports=r});var P=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&x(t,e)};var S=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},I=t(function(r){function o(t,e,n){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?r.exports=o=function(t,e,n){var r=[null];r.push.apply(r,e);var o=new(Function.bind.apply(t,r));return n&&x(o,n.prototype),o}:r.exports=o=Reflect.construct,o.apply(null,arguments)}r.exports=o}),O=function(t){function i(t){var e;a(this,i);for(var n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return e=C(this,L(i).call(this,r,i)),Error.captureStackTrace(N(e),i),e.code=t,e}return P(i,t),e(i,[{key:"toString",value:function(){return"".concat(this.name,"(").concat(this.code,"): ").concat(this.message)}}]),i}(t(function(e){function r(t){var n="function"==typeof Map?new Map:void 0;return e.exports=r=function(t){if(null===t||!S(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return I(t,arguments,L(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),x(e,t)},r(t)}e.exports=r})(Error)),U=function(t){var e=u(t);return v.digest({name:"SHA-256"},e).then(function(t){return function(t){for(var e=[],n=new DataView(t),r=0;r<n.byteLength;r+=4){var o="00000000",i=(o+n.getUint32(r).toString(16)).slice(-o.length);e.push(i)}return e.join("")}(t)})},B=function(){var t,e,n=window.localStorage.getItem("wwpassNonce");if(!n)return[];try{return t=JSON.parse(n),e=window.Date.now(),t.filter(function(t){return t.deadline>e})}catch(t){throw window.localStorage.removeItem("wwpassNonce"),t}},M=function(t){window.localStorage.setItem("wwpassNonce",JSON.stringify(t))},K=function(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(!v)throw new O(h.SSL_REQUIRED,"Client-side encryption requires https.");var o=B();return U(t).then(function(e){var t=o.find(function(t){return e===t.hash}),n=t&&t.key?s(t.key):void 0;return r&&n&&(t.deadline=window.Date.now()+1e3*r,M(o)),n})},D=function(e){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:120;if(!v)throw new O(h.SSL_REQUIRED,"Client-side encryption requires https.");return K(e).then(function(t){return t||v.generateKey({name:"AES-CBC",length:256},!0,["encrypt","decrypt"]).then(function(t){return e="raw",n=t,v.exportKey(e,n);var e,n}).then(function(r){return U(e).then(function(t){var e={hash:t,key:i(r),deadline:window.Date.now()+1e3*o},n=B();return n.push(e),M(n),r})})})},W=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:120;return T(t)?D(t,e):new Promise(function(t){t(void 0)})},F=new Uint8Array([176,178,97,142,156,31,45,30,81,210,85,14,202,203,86,240]),j=function(){function o(t,e){a(this,o),this.ivLen="AES-GCM"===e.name?12:16,"AES-GCM"===(this.algorithm=e).name&&Object.assign(this.algorithm,{tagLength:128}),this.clientKey=t}return e(o,[{key:"encryptArrayBuffer",value:function(t){var e,n=new Uint8Array(this.ivLen);e=n,g.getRandomValues(e);var r,o,i,a=this.algorithm;return Object.assign(a,{iv:n}),(r=a,o=this.clientKey,i=t,v.encrypt(r,o,i)).then(function(t){return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=e.reduce(function(t,e){return t+e.byteLength},0),o=0,i=new Uint8Array(r);0<e.length;)i.set(new Uint8Array(e[0]),o),o+=e[0].byteLength,e.shift();return i.buffer}(n.buffer,t)})}},{key:"encryptString",value:function(t){return this.encryptArrayBuffer(u(t)).then(i)}},{key:"decryptArrayBuffer",value:function(t){var e=this.algorithm;return Object.assign(e,{iv:t.slice(0,this.ivLen)}),y(e,this.clientKey,t.slice(this.ivLen))}},{key:"decryptString",value:function(t){return this.decryptArrayBuffer(s(t)).then(n)}}],[{key:"getWWPassCrypto",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"AES-GCM",n=null,r={name:t,length:256};return p({ticket:e,clientKeyOnly:!0}).then(function(t){if(!t.clientKey)throw Error("No client key associated with the ticket ".concat(e));return n=t.clientKey,K(t.originalTicket?t.originalTicket:e,t.ttl)}).then(function(t){if(!t)throw new Error("No client key nonce associated with the ticket in this browser");return m("raw",t,{name:"AES-CBC"},!1,["encrypt","decrypt","wrapKey","unwrapKey"])}).then(function(t){return y({name:"AES-CBC",iv:F},t,s(n))}).then(function(t){return m("raw",t,r,!1,["encrypt","decrypt","wrapKey","unwrapKey"])}).then(function(t){return new o(t,r)}).catch(function(t){if(void 0!==t.reason)throw new Error(t.reason);throw t})}}]),o}(),H=t(function(t){var e=function(i){var s,t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",r=e.toStringTag||"@@toStringTag";function a(t,e,n,r){var i,a,c,s,o=e&&e.prototype instanceof w?e:w,u=Object.create(o.prototype),l=new N(r||[]);return u._invoke=(i=t,a=n,c=l,s=h,function(t,e){if(s===p)throw new Error("Generator is already running");if(s===g){if("throw"===t)throw e;return L()}for(c.method=t,c.arg=e;;){var n=c.delegate;if(n){var r=T(n,c);if(r){if(r===v)continue;return r}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(s===h)throw s=g,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);s=p;var o=f(i,a,c);if("normal"===o.type){if(s=c.done?g:d,o.arg===v)continue;return{value:o.arg,done:c.done}}"throw"===o.type&&(s=g,c.method="throw",c.arg=o.arg)}}),u}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}i.wrap=a;var h="suspendedStart",d="suspendedYield",p="executing",g="completed",v={};function w(){}function c(){}function l(){}var y={};y[o]=function(){return this};var m=Object.getPrototypeOf,E=m&&m(m(C([])));E&&E!==t&&u.call(E,o)&&(y=E);var b=l.prototype=w.prototype=Object.create(y);function R(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function _(s){var e;this._invoke=function(n,r){function t(){return new Promise(function(t,e){!function e(t,n,r,o){var i=f(s[t],s,n);if("throw"!==i.type){var a=i.arg,c=a.value;return c&&"object"==typeof c&&u.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,r,o)},function(t){e("throw",t,r,o)}):Promise.resolve(c).then(function(t){a.value=t,r(a)},function(t){return e("throw",t,r,o)})}o(i.arg)}(n,r,t,e)})}return e=e?e.then(t,t):t()}}function T(t,e){var n=t.iterator[e.method];if(n===s){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=s,T(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=f(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,v;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=s),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(u.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=s,t.done=!0,t};return r.next=r}}return{next:L}}function L(){return{value:s,done:!0}}return c.prototype=b.constructor=l,l.constructor=c,l[r]=c.displayName="GeneratorFunction",i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===c||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,r in t||(t[r]="GeneratorFunction")),t.prototype=Object.create(b),t},i.awrap=function(t){return{__await:t}},R(_.prototype),_.prototype[n]=function(){return this},i.AsyncIterator=_,i.async=function(t,e,n,r){var o=new _(a(t,e,n,r));return i.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},R(b),b[r]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},i.keys=function(n){var r=[];for(var t in n)r.push(t);return r.reverse(),function t(){for(;r.length;){var e=r.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=C,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(A),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=s)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function t(t,e){return i.type="throw",i.arg=n,r.next=t,e&&(r.method="next",r.arg=s),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var o=this.tryEntries[e],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=u.call(o,"catchLoc"),c=u.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=s),v}},i}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}});function q(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}var Y=function(c){return function(){var t=this,a=arguments;return new Promise(function(e,n){var r=c.apply(t,a);function o(t){q(r,e,n,o,i,"next",t)}function i(t){q(r,e,n,o,i,"throw",t)}o(void 0)})}},V={pragma:"no-cache","cache-control":"no-cache"},z=function(e){return fetch(e,{cache:"no-store",headers:V}).then(function(t){if(!t.ok)throw Error('Error fetching ticket from "'.concat(e,'": ').concat(t.statusText));return t.json()})},J=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=f({},{ppx:"wwp_",version:2,status:200,reason:"OK",ticket:void 0,callbackURL:void 0,hw:!1},t),n="";"string"==typeof e.callbackURL&&(n=e.callbackURL);var r=-1===n.indexOf("?")?"?":"&";return n+="".concat(r+encodeURIComponent(e.ppx),"version=").concat(e.version),n+="&".concat(encodeURIComponent(e.ppx),"ticket=").concat(encodeURIComponent(e.ticket)),n+="&".concat(encodeURIComponent(e.ppx),"status=").concat(encodeURIComponent(e.status)),n+="&".concat(encodeURIComponent(e.ppx),"reason=").concat(encodeURIComponent(e.reason)),e.hw&&(n+="&".concat(encodeURIComponent(e.ppx),"hw=1")),n},Q=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=f({},{universal:!1,operation:"auth",ppx:"wwp_",version:2,ticket:void 0,callbackURL:void 0,clientKey:void 0},t),r=n.universal?"https://get.wwpass.com/":"wwpass://";return"auth"===n.operation?(r+="auth",r+="?v=".concat(n.version),r+="&t=".concat(encodeURIComponent(n.ticket)),r+="&ppx=".concat(encodeURIComponent(n.ppx)),n.clientKey&&(r+="&ck=".concat(n.clientKey)),n.callbackURL&&e&&(r+="&c=".concat(encodeURIComponent(n.callbackURL)))):r+="".concat(encodeURIComponent(n.operation),"?t=").concat(encodeURIComponent(n.ticket)),r},G=function(t){"function"==typeof t.callbackURL?t.callbackURL(J(t)):window.location.href=J(t)},$={}.toString,Z=Array.isArray||function(t){return"[object Array]"==$.call(t)},X=2147483647;function tt(t,e,n){return"number"==typeof t?rt(t):function(t,e,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer)return function(t,e,n){if(e<0||t.byteLength<e)throw new RangeError("'offset' is out of bounds");if(t.byteLength<e+(n||0))throw new RangeError("'length' is out of bounds");var r;r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n);return r.__proto__=tt.prototype,r}(t,e,n);return"string"!=typeof t?function(t){if(tt.isBuffer(t)){var e=0|et(t.length),n=nt(e);return 0===n.length||t.copy(n,0,0,e),n}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?nt(0):ot(t);if("Buffer"===t.type&&Array.isArray(t.data))return ot(t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t):(r=t,o=0|at(r),i=nt(o),a=i.write(r),a!==o&&(i=i.slice(0,a)),i);var r,o,i,a}(t,e,n)}function et(t){if(X<=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+X.toString(16)+" bytes");return 0|t}function nt(t){var e=new Uint8Array(t);return e.__proto__=tt.prototype,e}function rt(t){return nt(t<0?0:0|et(t))}function ot(t){for(var e=t.length<0?0:0|et(t.length),n=nt(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function it(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],a=0;a<r;++a){if(55295<(n=t.charCodeAt(a))&&n<57344){if(!o){if(56319<n){-1<(e-=3)&&i.push(239,191,189);continue}if(a+1===r){-1<(e-=3)&&i.push(239,191,189);continue}o=n;continue}if(n<56320){-1<(e-=3)&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&-1<(e-=3)&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function at(t){return tt.isBuffer(t)?t.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)?t.byteLength:("string"!=typeof t&&(t=""+t),0===t.length?0:it(t).length)}tt.prototype.__proto__=Uint8Array.prototype,tt.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&tt[Symbol.species]===tt&&Object.defineProperty(tt,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),tt.prototype.write=function(t,e,n){void 0===e?(n=this.length,e=0):void 0===n&&"string"==typeof e?(n=this.length,e=0):isFinite(e)&&(e|=0,isFinite(n)?n|=0:n=void 0);var r,o,i,a=this.length-e;if((void 0===n||a<n)&&(n=a),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return o=e,i=n,function(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}(it(t,(r=this).length-o),r,o,i)},tt.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return r.__proto__=tt.prototype,r},tt.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;0<=o;--o)t[o+e]=this[o+n];else if(i<1e3)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},tt.prototype.fill=function(t,e,n){if("string"==typeof t){if("string"==typeof e?(e=0,n=this.length):"string"==typeof n&&(n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var i=tt.isBuffer(t)?t:new tt(t),a=i.length;for(o=0;o<n-e;++o)this[o+e]=i[o%a]}return this},tt.concat=function(t,e){if(!Z(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return nt(null);var n;if(void 0===e)for(n=e=0;n<t.length;++n)e+=t[n].length;var r=rt(e),o=0;for(n=0;n<t.length;++n){var i=t[n];if(!tt.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},tt.byteLength=at,tt.prototype._isBuffer=!0,tt.isBuffer=function(t){return!(null==t||!t._isBuffer)};var ct,st=tt,ut=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],lt={getSymbolSize:function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||40<t)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},getSymbolTotalCodewords:function(t){return ut[t]},getBCHDigit:function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},setToSJISFunction:function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');ct=t},isKanjiModeEnabled:function(){return void 0!==ct},toSJIS:function(t){return ct(t)}},ft=t(function(t,n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2},n.isValid=function(t){return t&&void 0!==t.bit&&0<=t.bit&&t.bit<4},n.from=function(t,e){if(n.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return e}}});ft.L,ft.M,ft.Q,ft.H,ft.isValid;function ht(){this.buffer=[],this.length=0}ht.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var dt=ht;function pt(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new st(t*t),this.data.fill(0),this.reservedBit=new st(t*t),this.reservedBit.fill(0)}pt.prototype.set=function(t,e,n,r){var o=t*this.size+e;this.data[o]=n,r&&(this.reservedBit[o]=!0)},pt.prototype.get=function(t,e){return this.data[t*this.size+e]},pt.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n},pt.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var gt=pt,vt=t(function(t,a){var c=lt.getSymbolSize;a.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,n=c(t),r=145===n?26:2*Math.ceil((n-13)/(2*e-2)),o=[n-7],i=1;i<e-1;i++)o[i]=o[i-1]-r;return o.push(6),o.reverse()},a.getPositions=function(t){for(var e=[],n=a.getRowColCoords(t),r=n.length,o=0;o<r;o++)for(var i=0;i<r;i++)0===o&&0===i||0===o&&i===r-1||o===r-1&&0===i||e.push([n[o],n[i]]);return e}}),wt=(vt.getRowColCoords,vt.getPositions,lt.getSymbolSize),yt={getPositions:function(t){var e=wt(t);return[[0,0],[e-7,0],[0,e-7]]}},mt=t(function(t,c){c.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var l=3,a=3,s=40,o=10;function i(t,e,n){switch(t){case c.Patterns.PATTERN000:return(e+n)%2==0;case c.Patterns.PATTERN001:return e%2==0;case c.Patterns.PATTERN010:return n%3==0;case c.Patterns.PATTERN011:return(e+n)%3==0;case c.Patterns.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case c.Patterns.PATTERN101:return e*n%2+e*n%3==0;case c.Patterns.PATTERN110:return(e*n%2+e*n%3)%2==0;case c.Patterns.PATTERN111:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}c.getPenaltyN1=function(t){for(var e=t.size,n=0,r=0,o=0,i=null,a=null,c=0;c<e;c++){r=o=0,i=a=null;for(var s=0;s<e;s++){var u=t.get(c,s);u===i?r++:(5<=r&&(n+=l+(r-5)),i=u,r=1),(u=t.get(s,c))===a?o++:(5<=o&&(n+=l+(o-5)),a=u,o=1)}5<=r&&(n+=l+(r-5)),5<=o&&(n+=l+(o-5))}return n},c.getPenaltyN2=function(t){for(var e=t.size,n=0,r=0;r<e-1;r++)for(var o=0;o<e-1;o++){var i=t.get(r,o)+t.get(r,o+1)+t.get(r+1,o)+t.get(r+1,o+1);4!==i&&0!==i||n++}return n*a},c.getPenaltyN3=function(t){for(var e=t.size,n=0,r=0,o=0,i=0;i<e;i++){r=o=0;for(var a=0;a<e;a++)r=r<<1&2047|t.get(i,a),10<=a&&(1488===r||93===r)&&n++,o=o<<1&2047|t.get(a,i),10<=a&&(1488===o||93===o)&&n++}return n*s},c.getPenaltyN4=function(t){for(var e=0,n=t.data.length,r=0;r<n;r++)e+=t.data[r];return Math.abs(Math.ceil(100*e/n/5)-10)*o},c.applyMask=function(t,e){for(var n=e.size,r=0;r<n;r++)for(var o=0;o<n;o++)e.isReserved(o,r)||e.xor(o,r,i(t,o,r))},c.getBestMask=function(t,e){for(var n=Object.keys(c.Patterns).length,r=0,o=1/0,i=0;i<n;i++){e(i),c.applyMask(i,t);var a=c.getPenaltyN1(t)+c.getPenaltyN2(t)+c.getPenaltyN3(t)+c.getPenaltyN4(t);c.applyMask(i,t),a<o&&(o=a,r=i)}return r}}),Et=(mt.Patterns,mt.getPenaltyN1,mt.getPenaltyN2,mt.getPenaltyN3,mt.getPenaltyN4,mt.applyMask,mt.getBestMask,[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81]),bt=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],Rt={getBlocksCount:function(t,e){switch(e){case ft.L:return Et[4*(t-1)+0];case ft.M:return Et[4*(t-1)+1];case ft.Q:return Et[4*(t-1)+2];case ft.H:return Et[4*(t-1)+3];default:return}},getTotalCodewordsCount:function(t,e){switch(e){case ft.L:return bt[4*(t-1)+0];case ft.M:return bt[4*(t-1)+1];case ft.Q:return bt[4*(t-1)+2];case ft.H:return bt[4*(t-1)+3];default:return}}},_t=new st(512),Tt=new st(256);!function(){for(var t=1,e=0;e<255;e++)_t[e]=t,Tt[t]=e,256&(t<<=1)&&(t^=285);for(e=255;e<512;e++)_t[e]=_t[e-255]}();var kt=function(t){return _t[t]},At=function(t,e){return 0===t||0===e?0:_t[Tt[t]+Tt[e]]},Nt=t(function(t,r){r.mul=function(t,e){var n=new st(t.length+e.length-1);n.fill(0);for(var r=0;r<t.length;r++)for(var o=0;o<e.length;o++)n[r+o]^=At(t[r],e[o]);return n},r.mod=function(t,e){for(var n=new st(t);0<=n.length-e.length;){for(var r=n[0],o=0;o<e.length;o++)n[o]^=At(e[o],r);for(var i=0;i<n.length&&0===n[i];)i++;n=n.slice(i)}return n},r.generateECPolynomial=function(t){for(var e=new st([1]),n=0;n<t;n++)e=r.mul(e,[1,kt(n)]);return e}});Nt.mul,Nt.mod,Nt.generateECPolynomial;function Ct(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}Ct.prototype.initialize=function(t){this.degree=t,this.genPoly=Nt.generateECPolynomial(this.degree)},Ct.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=new st(this.degree);e.fill(0);var n=st.concat([t,e],t.length+this.degree),r=Nt.mod(n,this.genPoly),o=this.degree-r.length;if(0<o){var i=new st(this.degree);return i.fill(0),r.copy(i,o),i}return r};var Lt=Ct,xt="(?:[　-〿]|[぀-ゟ]|[゠-ヿ]|[＀-￯]|[一-龯]|[★-☆]|[←-↕]|※|[‐―‘’‥…“”∥≠]|[Α-ё]|[§¨±´×÷])+",Pt=new RegExp(xt,"g"),St=new RegExp("[^A-Z0-9 $%*+-./:]+","g"),It=new RegExp("(?:(?![A-Z0-9 $%*+-./:]|(?:[　-〿]|[぀-ゟ]|[゠-ヿ]|[＀-￯]|[一-龯]|[★-☆]|[←-↕]|※|[‐―‘’‥…“”∥≠]|[Α-ё]|[§¨±´×÷])+).)+","g"),Ot=new RegExp("[0-9]+","g"),Ut=new RegExp("[A-Z $%*+-./:]+","g"),Bt=new RegExp("^"+xt+"$"),Mt=new RegExp("^[0-9]+$"),Kt=new RegExp("^[A-Z0-9 $%*+-./:]+$"),Dt={KANJI:Pt,BYTE_KANJI:St,BYTE:It,NUMERIC:Ot,ALPHANUMERIC:Ut,testKanji:function(t){return Bt.test(t)},testNumeric:function(t){return Mt.test(t)},testAlphanumeric:function(t){return Kt.test(t)}},Wt=t(function(t,n){n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!Ft.isValid(e))throw new Error("Invalid version: "+e);return 1<=e&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},n.getBestModeForData=function(t){return Dt.testNumeric(t)?n.NUMERIC:Dt.testAlphanumeric(t)?n.ALPHANUMERIC:Dt.testKanji(t)?n.KANJI:n.BYTE},n.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},n.isValid=function(t){return t&&t.bit&&t.ccBits},n.from=function(t,e){if(n.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return e}}}),Ft=(Wt.NUMERIC,Wt.ALPHANUMERIC,Wt.BYTE,Wt.KANJI,Wt.MIXED,Wt.getCharCountIndicator,Wt.getBestModeForData,Wt.isValid,t(function(t,i){var n=lt.getBCHDigit(7973);function a(t,e){return Wt.getCharCountIndicator(t,e)+4}function o(t,n){var r=0;return t.forEach(function(t){var e=a(t.mode,n);r+=e+t.getBitsLength()}),r}i.isValid=function(t){return!isNaN(t)&&1<=t&&t<=40},i.from=function(t,e){return i.isValid(t)?parseInt(t,10):e},i.getCapacity=function(t,e,n){if(!i.isValid(t))throw new Error("Invalid QR Code version");void 0===n&&(n=Wt.BYTE);var r=8*(lt.getSymbolTotalCodewords(t)-Rt.getTotalCodewordsCount(t,e));if(n===Wt.MIXED)return r;var o=r-a(n,t);switch(n){case Wt.NUMERIC:return Math.floor(o/10*3);case Wt.ALPHANUMERIC:return Math.floor(o/11*2);case Wt.KANJI:return Math.floor(o/13);case Wt.BYTE:default:return Math.floor(o/8)}},i.getBestVersionForData=function(t,e){var n,r=ft.from(e,ft.M);if(Z(t)){if(1<t.length)return function(t,e){for(var n=1;n<=40;n++)if(o(t,n)<=i.getCapacity(n,e,Wt.MIXED))return n}(t,r);if(0===t.length)return 1;n=t[0]}else n=t;return function(t,e,n){for(var r=1;r<=40;r++)if(e<=i.getCapacity(r,n,t))return r}(n.mode,n.getLength(),r)},i.getEncodedBits=function(t){if(!i.isValid(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;0<=lt.getBCHDigit(e)-n;)e^=7973<<lt.getBCHDigit(e)-n;return t<<12|e}})),jt=(Ft.isValid,Ft.getCapacity,Ft.getBestVersionForData,Ft.getEncodedBits,lt.getBCHDigit(1335)),Ht={getEncodedBits:function(t,e){for(var n=t.bit<<3|e,r=n<<10;0<=lt.getBCHDigit(r)-jt;)r^=1335<<lt.getBCHDigit(r)-jt;return 21522^(n<<10|r)}};function qt(t){this.mode=Wt.NUMERIC,this.data=t.toString()}qt.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},qt.prototype.getLength=function(){return this.data.length},qt.prototype.getBitsLength=function(){return qt.getBitsLength(this.data.length)},qt.prototype.write=function(t){var e,n,r;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),r=parseInt(n,10),t.put(r,10);var o=this.data.length-e;0<o&&(n=this.data.substr(e),r=parseInt(n,10),t.put(r,3*o+1))};var Yt=qt,Vt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function zt(t){this.mode=Wt.ALPHANUMERIC,this.data=t}zt.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},zt.prototype.getLength=function(){return this.data.length},zt.prototype.getBitsLength=function(){return zt.getBitsLength(this.data.length)},zt.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var n=45*Vt.indexOf(this.data[e]);n+=Vt.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(Vt.indexOf(this.data[e]),6)};var Jt=zt;function Qt(t){this.mode=Wt.BYTE,this.data=new st(t)}Qt.getBitsLength=function(t){return 8*t},Qt.prototype.getLength=function(){return this.data.length},Qt.prototype.getBitsLength=function(){return Qt.getBitsLength(this.data.length)},Qt.prototype.write=function(t){for(var e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)};var Gt=Qt;function $t(t){this.mode=Wt.KANJI,this.data=t}$t.getBitsLength=function(t){return 13*t},$t.prototype.getLength=function(){return this.data.length},$t.prototype.getBitsLength=function(){return $t.getBitsLength(this.data.length)},$t.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var n=lt.toSJIS(this.data[e]);if(33088<=n&&n<=40956)n-=33088;else{if(!(57408<=n&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");n-=49472}n=192*(n>>>8&255)+(255&n),t.put(n,13)}};var Zt=$t,Xt=t(function(t){var p={single_source_shortest_paths:function(t,e,n){var r={},o={};o[e]=0;var i,a,c,s,u,l,f,h=p.PriorityQueue.make();for(h.push(e,0);!h.empty();)for(c in a=(i=h.pop()).value,s=i.cost,u=t[a]||{})u.hasOwnProperty(c)&&(l=s+u[c],f=o[c],(void 0===o[c]||l<f)&&(o[c]=l,h.push(c,l),r[c]=a));if(void 0===n||void 0!==o[n])return r;var d=["Could not find a path from ",e," to ",n,"."].join("");throw new Error(d)},extract_shortest_path_from_predecessor_list:function(t,e){for(var n=[],r=e;r;)n.push(r),t[r],r=t[r];return n.reverse(),n},find_path:function(t,e,n){var r=p.single_source_shortest_paths(t,e,n);return p.extract_shortest_path_from_predecessor_list(r,n)},PriorityQueue:{make:function(t){var e,n=p.PriorityQueue,r={};for(e in t=t||{},n)n.hasOwnProperty(e)&&(r[e]=n[e]);return r.queue=[],r.sorter=t.sorter||n.default_sorter,r},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var n={value:t,cost:e};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=p}),te=t(function(t,a){function c(t){return unescape(encodeURIComponent(t)).length}function i(t,e,n){for(var r,o=[];null!==(r=t.exec(n));)o.push({data:r[0],index:r.index,mode:e,length:r[0].length});return o}function s(t){var e,n,r=i(Dt.NUMERIC,Wt.NUMERIC,t),o=i(Dt.ALPHANUMERIC,Wt.ALPHANUMERIC,t);return n=lt.isKanjiModeEnabled()?(e=i(Dt.BYTE,Wt.BYTE,t),i(Dt.KANJI,Wt.KANJI,t)):(e=i(Dt.BYTE_KANJI,Wt.BYTE,t),[]),r.concat(o,e,n).sort(function(t,e){return t.index-e.index}).map(function(t){return{data:t.data,mode:t.mode,length:t.length}})}function d(t,e){switch(e){case Wt.NUMERIC:return Yt.getBitsLength(t);case Wt.ALPHANUMERIC:return Jt.getBitsLength(t);case Wt.KANJI:return Zt.getBitsLength(t);case Wt.BYTE:return Gt.getBitsLength(t)}}function n(t,e){var n,r=Wt.getBestModeForData(t);if((n=Wt.from(e,r))!==Wt.BYTE&&n.bit<r.bit)throw new Error('"'+t+'" cannot be encoded with mode '+Wt.toString(n)+".\n Suggested mode is: "+Wt.toString(r));switch(n!==Wt.KANJI||lt.isKanjiModeEnabled()||(n=Wt.BYTE),n){case Wt.NUMERIC:return new Yt(t);case Wt.ALPHANUMERIC:return new Jt(t);case Wt.KANJI:return new Zt(t);case Wt.BYTE:return new Gt(t)}}a.fromArray=function(t){return t.reduce(function(t,e){return"string"==typeof e?t.push(n(e,null)):e.data&&t.push(n(e.data,e.mode)),t},[])},a.fromString=function(t,e){for(var n=function(t,e){for(var n={},r={start:{}},o=["start"],i=0;i<t.length;i++){for(var a=t[i],c=[],s=0;s<a.length;s++){var u=a[s],l=""+i+s;c.push(l),n[l]={node:u,lastCount:0},r[l]={};for(var f=0;f<o.length;f++){var h=o[f];n[h]&&n[h].node.mode===u.mode?(r[h][l]=d(n[h].lastCount+u.length,u.mode)-d(n[h].lastCount,u.mode),n[h].lastCount+=u.length):(n[h]&&(n[h].lastCount=u.length),r[h][l]=d(u.length,u.mode)+4+Wt.getCharCountIndicator(u.mode,e))}}o=c}for(f=0;f<o.length;f++)r[o[f]].end=0;return{map:r,table:n}}(function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];switch(r.mode){case Wt.NUMERIC:e.push([r,{data:r.data,mode:Wt.ALPHANUMERIC,length:r.length},{data:r.data,mode:Wt.BYTE,length:r.length}]);break;case Wt.ALPHANUMERIC:e.push([r,{data:r.data,mode:Wt.BYTE,length:r.length}]);break;case Wt.KANJI:e.push([r,{data:r.data,mode:Wt.BYTE,length:c(r.data)}]);break;case Wt.BYTE:e.push([{data:r.data,mode:Wt.BYTE,length:c(r.data)}])}}return e}(s(t,lt.isKanjiModeEnabled())),e),r=Xt.find_path(n.map,"start","end"),o=[],i=1;i<r.length-1;i++)o.push(n.table[r[i]].node);return a.fromArray(o.reduce(function(t,e){var n=0<=t.length-1?t[t.length-1]:null;return n&&n.mode===e.mode?t[t.length-1].data+=e.data:t.push(e),t},[]))},a.rawSplit=function(t){return a.fromArray(s(t,lt.isKanjiModeEnabled()))}});te.fromArray,te.fromString,te.rawSplit;function ee(t,e,n){var r,o,i=t.size,a=Ht.getEncodedBits(e,n);for(r=0;r<15;r++)o=1==(a>>r&1),r<6?t.set(r,8,o,!0):r<8?t.set(r+1,8,o,!0):t.set(i-15+r,8,o,!0),r<8?t.set(8,i-r-1,o,!0):r<9?t.set(8,15-r-1+1,o,!0):t.set(8,15-r-1,o,!0);t.set(i-8,8,1,!0)}function ne(e,t,n){var r=new dt;n.forEach(function(t){r.put(t.mode.bit,4),r.put(t.getLength(),Wt.getCharCountIndicator(t.mode,e)),t.write(r)});var o=8*(lt.getSymbolTotalCodewords(e)-Rt.getTotalCodewordsCount(e,t));for(r.getLengthInBits()+4<=o&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(0);for(var i=(o-r.getLengthInBits())/8,a=0;a<i;a++)r.put(a%2?17:236,8);return function(t,e,n){for(var r=lt.getSymbolTotalCodewords(e),o=Rt.getTotalCodewordsCount(e,n),i=r-o,a=Rt.getBlocksCount(e,n),c=a-r%a,s=Math.floor(r/a),u=Math.floor(i/a),l=u+1,f=s-u,h=new Lt(f),d=0,p=new Array(a),g=new Array(a),v=0,w=new st(t.buffer),y=0;y<a;y++){var m=y<c?u:l;p[y]=w.slice(d,d+m),g[y]=h.encode(p[y]),d+=m,v=Math.max(v,m)}var E,b,R=new st(r),_=0;for(E=0;E<v;E++)for(b=0;b<a;b++)E<p[b].length&&(R[_++]=p[b][E]);for(E=0;E<f;E++)for(b=0;b<a;b++)R[_++]=g[b][E];return R}(r,e,t)}function re(t,e,n){var r;if(Z(t))r=te.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var o=e;if(!o){var i=te.rawSplit(t);o=Ft.getBestVersionForData(i,n)}r=te.fromString(t,o)}var a=Ft.getBestVersionForData(r,n);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<a)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+a+".\n")}else e=a;var c=ne(e,n,r),s=lt.getSymbolSize(e),u=new gt(s);!function(t,e){for(var n=t.size,r=yt.getPositions(e),o=0;o<r.length;o++)for(var i=r[o][0],a=r[o][1],c=-1;c<=7;c++)if(!(i+c<=-1||n<=i+c))for(var s=-1;s<=7;s++)a+s<=-1||n<=a+s||(0<=c&&c<=6&&(0===s||6===s)||0<=s&&s<=6&&(0===c||6===c)||2<=c&&c<=4&&2<=s&&s<=4?t.set(i+c,a+s,!0,!0):t.set(i+c,a+s,!1,!0))}(u,e),function(t){for(var e=t.size,n=8;n<e-8;n++){var r=n%2==0;t.set(n,6,r,!0),t.set(6,n,r,!0)}}(u),function(t,e){for(var n=vt.getPositions(e),r=0;r<n.length;r++)for(var o=n[r][0],i=n[r][1],a=-2;a<=2;a++)for(var c=-2;c<=2;c++)-2===a||2===a||-2===c||2===c||0===a&&0===c?t.set(o+a,i+c,!0,!0):t.set(o+a,i+c,!1,!0)}(u,e),ee(u,n,0),7<=e&&function(t,e){for(var n,r,o,i=t.size,a=Ft.getEncodedBits(e),c=0;c<18;c++)n=Math.floor(c/3),r=c%3+i-8-3,o=1==(a>>c&1),t.set(n,r,o,!0),t.set(r,n,o,!0)}(u,e),function(t,e){for(var n=t.size,r=-1,o=n-1,i=7,a=0,c=n-1;0<c;c-=2)for(6===c&&c--;;){for(var s=0;s<2;s++)if(!t.isReserved(o,c-s)){var u=!1;a<e.length&&(u=1==(e[a]>>>i&1)),t.set(o,c-s,u),-1==--i&&(a++,i=7)}if((o+=r)<0||n<=o){o-=r,r=-r;break}}}(u,c);var l=mt.getBestMask(u,ee.bind(null,u,n));return mt.applyMask(l,u),ee(u,n,l),{modules:u,version:e,errorCorrectionLevel:n,maskPattern:l,segments:r}}var oe=function(t,e){if(void 0===t||""===t)throw new Error("No input text");var n,r=ft.M;return void 0!==e&&(r=ft.from(e.errorCorrectionLevel,ft.M),n=Ft.from(e.version),e.toSJISFunc&&lt.setToSJISFunction(e.toSJISFunc)),re(t,n,r)};function ie(t){if("string"!=typeof t)throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||8<e.length)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map(function(t){return[t,t]}))),6===e.length&&e.push("F","F");var n=parseInt(e.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n}}var ae=function(t){t||(t={}),t.color||(t.color={});var e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin;return{scale:t.scale||4,margin:e,color:{dark:ie(t.color.dark||"#000000ff"),light:ie(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},ce=function(t,e,n,r,o){for(var i=e.modules.size,a=e.modules.data,c=n*r,s=i*r+2*c,u=[o.light,o.dark],l=0;l<s;l++)for(var f=0;f<s;f++){var h=4*(l*s+f),d=o.light;c<=l&&c<=f&&l<s-c&&f<s-c&&(d=u[a[Math.floor((l-c)/r)*i+Math.floor((f-c)/r)]]),t[h++]=d.r,t[h++]=d.g,t[h++]=d.b,t[h]=d.a}},se=t(function(t,c){c.render=function(t,e,n){var r=n,o=e;void 0!==r||e&&e.getContext||(r=e,e=void 0),e||(o=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),r=ae(r);var i,a,c=(t.modules.size+2*r.margin)*r.scale,s=o.getContext("2d"),u=s.createImageData(c,c);return ce(u.data,t,r.margin,r.scale,r.color),i=o,a=c,s.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=a,i.width=a,i.style.height=a+"px",i.style.width=a+"px",s.putImageData(u,0,0),o},c.renderToDataURL=function(t,e,n){var r=n;void 0!==r||e&&e.getContext||(r=e,e=void 0),r||(r={});var o=c.render(t,e,r),i=r.type||"image/png",a=r.rendererOpts||{};return o.toDataURL(i,a.quality)}});se.render,se.renderToDataURL;function ue(t){return'fill="rgb('+[t.r,t.g,t.b].join(",")+')" fill-opacity="'+(t.a/255).toFixed(2)+'"'}var le=function(t,e){var n=ae(e),r=t.modules.size,o=t.modules.data,i=(r+2*n.margin)*n.scale,a='<?xml version="1.0" encoding="utf-8"?>\n';a+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n',a+='<svg version="1.1" baseProfile="full"',a+=' width="'+i+'" height="'+i+'"',a+=' viewBox="0 0 '+i+" "+i+'"',a+=' xmlns="http://www.w3.org/2000/svg"',a+=' xmlns:xlink="http://www.w3.org/1999/xlink"',a+=' xmlns:ev="http://www.w3.org/2001/xml-events">\n',a+='<rect x="0" y="0" width="'+i+'" height="'+i+'" '+ue(n.color.light)+" />\n",a+='<defs><rect id="p" width="'+n.scale+'" height="'+n.scale+'" /></defs>\n',a+="<g "+ue(n.color.dark)+">\n";for(var c=0;c<r;c++)for(var s=0;s<r;s++)o[c*r+s]&&(a+='<use x="'+(n.margin+s)*n.scale+'" y="'+(n.margin+c)*n.scale+'" xlink:href="#p" />\n');return a+="</g>\n",a+="</svg>"},fe=t(function(t,e){function n(t,e,n,r,o){var i=arguments.length-1;if(i<2)throw new Error("Too few arguments provided");if(2===i?(o=n,n=e,e=r=void 0):3===i&&(e.getContext&&void 0===o?(o=r,r=void 0):(o=r,r=n,n=e,e=void 0)),"function"!=typeof o)throw new Error("Callback required as last argument");try{o(null,t(oe(n,r),e,r))}catch(t){o(t)}}e.create=oe,e.toCanvas=n.bind(null,se.render),e.toDataURL=n.bind(null,se.renderToDataURL),e.toString=n.bind(null,function(t,e,n){return le(t,n)}),e.qrcodedraw=function(){return{draw:e.toCanvas}}}),he=(fe.create,fe.toCanvas,fe.toDataURL,fe.qrcodedraw,function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}),de=!1,pe=function(t,e){var n=e instanceof O&&e.code===h.SSL_REQUIRED,r=void 0!==window.navigator.onLine&&!window.navigator.onLine,o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.style.height="100%",o.style.width="100%";var i=document.createElement("div");i.style.margin="0 10%",i.style.width="80%",i.style.textAlign="center",i.style.overflow="hidden";var a="Error occured";n?a="Please use HTTPS":r&&(a="No internet connection"),i.innerHTML='<p style="margin:0; font-size: 1.2em; color: black;">'.concat(a,"</p>");var c=null;return n||((c=document.createElement("a")).textContent="Retry",c.style.fontWeight="400",c.style.fontFamily='"Arial", sans-serif',c.style.fontSize="1.2em",c.style.lineHeight="1.7em",c.style.cursor="pointer",c.href="#",i.appendChild(c)),o.appendChild(i),console.error("Error in WWPass Library: ".concat(e)),he(t),t.appendChild(o),n?Promise.reject(e.message):new Promise(function(e){setTimeout(function(){e({refresh:!0})},6e4),c.addEventListener("click",function(t){e({refresh:!0}),t.preventDefault()}),r&&window.addEventListener("online",function(){return e({refresh:!0})})})},ge=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"visible",n=null;return function(t){n=t,document.visibilityState===e?n():document.addEventListener("visibilitychange",function t(){document.visibilityState===e&&(n(),document.removeEventListener("visibilitychange",t))})}}(),ve=function(r,o,i,a){return new Promise(function(t){var e=document.createElement("canvas");if(fe.toCanvas(e,Q(o,!1),a||{},function(t){if(t)throw t}),a&&(e.className="".concat(a.prefix,"qrcode_canvas"),e.style.max_width="".concat(a.width,"px"),e.style.max_height="".concat(a.width,"px")),e.style.height="100%",e.style.width="100%",navigator&&("userAgent"in navigator&&navigator.userAgent.match(/iPhone|iPod|iPad|Android/i)||1<navigator.maxTouchPoints)&&!window.MSStream){var n=document.createElement("a");n.href=Q(o),n.appendChild(e),n.addEventListener("click",function(){t({away:!0})}),e=n}he(r),r.appendChild(e),setTimeout(function(){ge(function(){t({refresh:!0})})},900*i)})},we=function(t,e){return function(t,e){var n="".concat(e.prefix||"wwp_","qrcode_loader"),r=document.createElement("div");if(r.className=n,r.innerHTML='<div class="'.concat(n,'_blk"></div>\n  <div class="').concat(n,"_blk ").concat(n,'_delay"></div>\n  <div class="').concat(n,"_blk ").concat(n,'_delay"></div>\n  <div class="').concat(n,'_blk"></div>'),!de){var o=document.createElement("style");o.innerHTML="@keyframes ".concat(e.prefix||"wwp_","pulse {\n      0%   { opacity: 1; }\n      100% { opacity: 0; }\n    }\n    .").concat(n," {\n      display: flex;\n      flex-direction: row;\n      flex-wrap: wrap;\n      justify-content: space-around;\n      align-items: center;\n      width: 30%;\n      height: 30%;\n      margin-left: 35%;\n      margin-top: 35%;\n    }\n    .").concat(n,"_blk {\n      height: 35%;\n      width: 35%;\n      animation: ").concat(e.prefix||"wwp_","pulse 0.75s ease-in infinite alternate;\n      background-color: #cccccc;\n    }\n    .").concat(n,"_delay {\n      animation-delay: 0.75s;\n    }"),document.getElementsByTagName("head")[0].appendChild(o),de=!0}he(t),t.appendChild(r)}(t,e)};function ye(e){return e?new Promise(function(t){return setTimeout(t,e)}):null}var me,Ee=function(){var e=Y(H.mark(function t(e){var n,r,o,i,a,c,s,u;return H.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.log,t.prev=1,n(e),we(e.qrcode,e.qrcodeStyle),t.next=6,z(e.ticketURL);case 6:return r=t.sent,o=k(r),i=o.ticket,a=o.ttl,t.next=12,W(i,a);case 12:return c=t.sent,s={universal:e.universal,ticket:i,callbackURL:e.callbackURL,ppx:e.ppx,version:2,clientKey:c?w(c):void 0},t.next=16,Promise.race([ve(e.qrcode,s,a,e.qrcodeStyle),p({callbackURL:e.callbackURL,ticket:i,log:n,development:e.development,version:e.version,ppx:e.ppx,spfewsAddress:e.spfewsAddress})]);case 16:if(u=t.sent,we(e.qrcode,e.qrcodeStyle),u.refresh)return t.abrupt("return",{status:h.CONTINUE,reason:"Need to refresh QRCode"});t.next=20;break;case 20:if(u.clientKey&&e.catchClientKey&&e.catchClientKey(u.clientKey),u.away)return l(),t.abrupt("return",{status:h.OK,reason:"User clicked on QRCode"});t.next=24;break;case 24:return G(u),t.abrupt("return",u);case 28:if(t.prev=28,t.t0=t.catch(1),t.t0.status){t.next=36;break}return n("QRCode auth error",t.t0),t.next=34,pe(e.qrcode,t.t0);case 34:return we(e.qrcode,e.qrcodeStyle),t.abrupt("return",{status:h.NETWORK_ERROR,reason:t.t0});case 36:if(we(e.qrcode,e.qrcodeStyle),t.t0.status===h.INTERNAL_ERROR||e.returnErrors)return G(t.t0),t.abrupt("return",t.t0);t.next=40;break;case 40:return t.t0.status===h.TICKET_TIMEOUT&&n("ticket timed out"),t.abrupt("return",t.t0);case 42:case"end":return t.stop()}},t,null,[[1,28]])}));return function(t){return e.apply(this,arguments)}}(),be=function(t){switch(t){case h.OK:return 2e3;case h.CONTINUE:return 0;default:return 500}},Re=function(){var e=Y(H.mark(function t(e){var n,r,o;return H.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((r=f({},n={universal:!1,ticketURL:void 0,callbackURL:void 0,development:!1,once:!1,version:2,ppx:"wwp_",spfewsAddress:"wss://spfews.wwpass.com",qrcodeStyle:{width:256,prefix:"wwp_"},log:function(){}},e)).qrcodeStyle=f({},n.qrcodeStyle,e.qrcodeStyle),r.ticketURL){t.next=5;break}throw Error("ticketURL not found");case 5:if(r.callbackURL){t.next=7;break}throw Error("callbackURL not found");case 7:if(r.qrcode){t.next=9;break}throw Error("Element not found");case 9:return t.next=11,Ee(r);case 11:if(o=t.sent,r.once&&o.status!==h.CONTINUE)return t.abrupt("return",o);t.next=14;break;case 14:return t.next=16,ye(be(o.status));case 16:if(document.documentElement.contains(r.qrcode)){t.next=9;break}case 17:return t.abrupt("return",{status:h.TERMINAL_ERROR,reason:"QRCode element is not in DOM"});case 18:case"end":return t.stop()}},t)}));return function(t){return e.apply(this,arguments)}}(),_e="https:"===window.location.protocol?"https:":"http:",Te="".concat(_e,"//cdn.wwpass.com/packages/wwpass.js/2.4/wwpass.js.css"),ke=function(t){return"".concat("WWPass authentication is not supported on"," ").concat(t)},Ae=function(t,e,n){if(!document.getElementById("_wwpass_css")){var r=document.createElement("link");r.id="_wwpass_css",r.rel="stylesheet",r.href=Te,document.head.appendChild(r)}var o=document.createElement("div");o.id="_wwpass_err_dlg";var i=document.createElement("span");i.innerHTML="Close",i.id="_wwpass_err_close";var a=document.createElement("h1");a.innerHTML=e;var c=document.createElement("div");return c.innerHTML=t,o.appendChild(a),o.appendChild(c),o.appendChild(i),document.body.appendChild(o),document.getElementById("_wwpass_err_close").addEventListener("click",function(){var t=document.getElementById("_wwpass_err_dlg");return t.parentNode.removeChild(t),n(),!1}),!0},Ne=function(t,e){if(t===h.NO_AUTH_INTERFACES_FOUND){var n=function(){var t=navigator.userAgent,e=/Firefox\/([0-9]+)\./,n=t.match(e);if(n&&1<n.length){var r=n[1];if(51<=Number(r))return"Firefox"}if(e=/Chrome\/([0-9]+)\./,(n=t.match(e))&&1<n.length){var o=n[1];if(45<=Number(o))return"Chrome"}return!1}(),r="";if(n){if("Chrome"===n){var o=encodeURIComponent(window.location.href);r="<p>The WWPass Authentication extension for Chrome is not installed or is disabled in browser settings.",r+="<p>Click the link below to install and enable the WWPass Authentication extension.",r+='<p><a href="https://chrome.wwpass.com/?callbackURL='.concat(o,'">Install WWPass Authentication Extension</a>')}else if("Firefox"===n){var i=encodeURIComponent(window.location.href);r="<p>The WWPass Authentication extension for Firefox is not installed or is disabled in browser settings.",r+="<p>Click the link below to install and enable the WWPass Authentication extension.",r+='<p><a href="https://firefox.wwpass.com/?callbackURL='.concat(i,'">Install WWPass Authentication Extension</a>')}}else r='<p>No Security Pack is found on your computer or WWPass&nbsp;Browser&nbsp;Plugin is disabled.</p><p>To install Security Pack visit <a href="https://ks.wwpass.com/download/">Key Services</a> or check plugin settings of your browser to activate WWPass&nbsp;Browser&nbsp;Plugin.</p><p><a href="https://support.wwpass.com/?topic=604">Learn more...</a></p>';Ae(r,"WWPass &mdash; No Software Found",e)}else t===h.UNSUPPORTED_PLATFORM&&Ae(ke(function(){for(var t=navigator.userAgent,e=["Android","iPhone","iPad"],n=0;n<e.length;n+=1)if(-1!==t.search(new RegExp(e[n],"i")))return e[n];return null}()),"WWPass &mdash; Unsupported Platform",e)},Ce="_wwpass_plugin",Le="application/x-wwauth",xe={},Pe=[],Se=function(){return void 0!==navigator.mimeTypes[Le]},Ie=function(a){return new Promise(function(e,n){if(me)void 0!==window._wwpass_plugin_loaded?Pe.push([e,n]):(a("%s: plugin is already initialized","getPluginInstance"),e(me));else{var t=0===navigator.mimeTypes.length;if(Se()||t){a("%s: trying to create plugin instance(junkBrowser=%s, timeout=%d)","getPluginInstance",t,t?1e3:1e4);var r="<object id='".concat(Ce,"' width=0 height=0 type='").concat(Le,"'><param name='onload' value='_wwpass_plugin_loaded'/></object>"),o=document.createElement("div");o.setAttribute("style","position: fixed; left: 0; top:0; width: 1px; height: 1px; z-index: -1; opacity: 0.01"),document.body.appendChild(o),o.innerHTML+=r,me=document.getElementById(Ce);var i=setTimeout(function(){delete window._wwpass_plugin_loaded,me=null,a("%s: WWPass plugin loading timeout","getPluginInstance"),n({code:h.NO_AUTH_INTERFACES_FOUND,message:c});for(var t=0;t<Pe.length;t+=1){(0,Pe[t][1])({code:h.NO_AUTH_INTERFACES_FOUND,message:c})}},1e4);window._wwpass_plugin_loaded=function(){a("%s: plugin loaded","getPluginInstance"),delete window._wwpass_plugin_loaded,clearTimeout(i);try{xe.versionString=me.version,xe.revision=parseInt(me.version.split(".")[2],10),xe.showsErrors=function(t){if("string"==typeof t){for(var e=t.split("."),n=0;n<e.length;n+=1)e[n]=parseInt(e[n],10);if(3===e.length&&(2<e[0]||2===e[0]&&4<e[1]||2===e[0]&&4===e[1]&&1305<=e[2]))return!0}return!1}(xe.versionString)}catch(t){a("%s: error parsing plugin version: %s","getPluginInstance",t)}e(me);for(var t=0;t<Pe.length;t+=1){(0,Pe[t][0])(me)}}}else a("%s: no suitable plugins installed","getPluginInstance"),n({code:h.NO_AUTH_INTERFACES_FOUND,message:c})}})},Oe=function(t){return new Promise(function(n,o){var i=f({},{log:function(){}},t);i.log('%s: called, operation name is "%s"',"wwpassPluginExecute",i.operation||null),Ie(i.log).then(function(t){var r,e=(r=function(t,e){t===h.OK?n(e):o({code:t,message:e})},xe.showsErrors?r:function(t,e){if(t!==h.OK&&t!==h.USER_REJECT){var n="<p><b>A error has occured:</b> ".concat(e,"</p>")+'<p><a href="https://support.wwpass.com/?topic='.concat(t,'">Learn more</a></p>');Ae(n,"WWPass Error",function(){r(t,e)})}else r(t,e)});void 0!==t.execute?(i.callback=e,t.execute(i)):"auth"===i.operation?xe.revision<9701?t.authenticate(i.ticket,e):t.authenticate(i.ticket,e,i.firstKeyType||"passkey"):t.do_operation(i.operation,e)}).catch(o)})},Ue=function(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise(function(e,t){Ie(n).then(function(t){t.on_key_removed(e)}).catch(t)})},Be=!1,Me=function(){return null!==(document.querySelector('meta[property="wwpass:extension:version"]')||document.getElementById("_WWAuth_Chrome_Installed_"))},Ke=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){};return new Promise(function(r,o){if(Be)return n("%s: chrome native messaging extension is not installed","wwpassNMExecute"),void o({code:h.NO_AUTH_INTERFACES_FOUND,message:c});!function t(e){var n,r=e.condition;if("function"==typeof r&&(r=r()),r)e.onCondition();else{var o=e.attempts||0;if(o--){var i=e.timeout||100;setTimeout((n={timeout:i,attempts:o,condition:e.condition,onCondition:e.onCondition,onTimeout:e.onTimeout},function(){t(n)}),i)}else e.onTimeout()}}({timeout:200,attempts:15,condition:Me,onCondition:function(){var n=(4294967296*(1+Math.random())|0).toString(16).substring(1);window.postMessage({type:"_WWAuth_Message",src:"client",id:n,func:t,args:e?JSON.parse(JSON.stringify(e)):e},"*"),window.addEventListener("message",function t(e){if("_WWAuth_Message"===e.data.type&&"plugin"===e.data.src&&e.data.id===n)if(window.removeEventListener("message",t,!1),e.data.code===h.NO_AUTH_INTERFACES_FOUND){Ae('<p>No Security Pack is found on your computer or WWPass&nbsp;native&nbsp;host is not responding.</p><p>To install Security Pack visit <a href="https://ks.wwpass.com/download/">Key Services</a> </p><p><a href="https://support.wwpass.com/?topic=604">Learn more...</a></p>',"WWPass Error",function(){o({code:e.data.code,message:e.data.ticketOrMessage})})}else e.data.code===h.OK?r(e.data.ticketOrMessage):o({code:e.data.code,message:e.data.ticketOrMessage})},!1)},onTimeout:function(){Be=!0,n("%s: chrome native messaging extension is not installed","wwpassNMExecute"),o({code:h.NO_AUTH_INTERFACES_FOUND,message:c})}})})},De=function(t){var e=f({},{log:function(){}},t),n=e.log;return delete e.log,n("%s: called","wwpassNMExecute"),e.uri={domain:window.location.hostname,protocol:window.location.protocol},Ke("exec",[e],n)},We=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){};return Ke("on_key_rm",void 0,t)},Fe=function(){return Se()||Me()},je=function e(n,r,o,i){n.pop()(r).then(o,function(t){t.code===h.NO_AUTH_INTERFACES_FOUND?0<n.length?e(n,r,o,i):(Ne(t.code,function(){}),i(t)):i(t)})},He=function(r,o,i){return new Promise(function(t,e){var n=function(){for(var t=navigator.userAgent,e=["Android","iPhone","iPad"],n=0;n<e.length;n+=1)if(-1!==t.search(new RegExp(e[n],"i")))return e[n];return null}();null===n?Se()?je([r,o],i,t,e):je([o,r],i,t,e):Ne(h.UNSUPPORTED_PLATFORM,function(){e({code:h.UNSUPPORTED_PLATFORM,message:ke(n)})})})},qe=function(r){return z(r.ticketURL).then(function(t){var e=k(t),n=e.ticket;return W(n,e.ttl).then(function(t){return e={ticket:n,clientKeyNonce:void 0!==t?i(t):void 0,log:r.log},He(De,Oe,f({},e,{operation:"auth"}));var e}).then(function(){return n})})},Ye=function(e,n,r){var t;0===e.passkeyButton.innerHTML.length&&e.passkeyButton.appendChild(((t=document.createElement("button")).innerHTML='<svg id="icon-button_logo" viewBox="0 0 34 20" style="fill: none; left: 28px; stroke-width: 2px; width: 35px; height: 25px; top: 5px; position: absolute;"><switch><g><title>button_logo</title><path fill="#FFF" d="M31.2 20h-28c-1.7 0-3-1.3-3-3V3c0-1.7 1.3-3 3-3h27.4C32.5 0 34 1.6 34 3.6c0 1.3-.8 2.5-1.9 3L34 16.8c.2 1.6-.9 3-2.5 3.1-.1.1-.2.1-.3.1zM27 6h-1c-1.1 0-2 .9-2 2v1h-8.3c-.8-2.8-3.8-4.4-6.5-3.5S4.8 9.2 5.6 12s3.8 4.4 6.5 3.5c1.7-.5 3-1.8 3.5-3.5H27V6zm-1 1c-.6 0-1 .4-1 1v2H12.1V8.3c0-.2-.1-.3-.2-.3h-.2l-3.6 2.3c-.1.1-.2.3-.1.4l.1.1 3.6 2.2c.1.1.3 0 .4-.1V11H26V7z"></path></g></switch></svg> Log in with PassKey',t.setAttribute("style",'color: white; background-color: #2277E6; font-weight: 400; font-size: 18px; line-height: 36px; font-family: "Arial", sans-serif; padding-right: 15px; cursor: pointer; height: 40px; width: 255px; border-radius: 3px; border: 1px solid #2277E6; padding-left: 60px; text-decoration: none; position: relative;'),t));var o=!1;e.passkeyButton.addEventListener("click",function(t){o||(o=!0,qe(e).then(function(t){o=!1,n({ppx:e.ppx,version:e.version,code:h.OK,message:"OK",ticket:t,callbackURL:e.callbackURL,hw:!0})},function(t){o=!1,t.code?(t.code===h.INTERNAL_ERROR||e.returnErrors)&&r({ppx:e.ppx,version:e.version,code:t.code,message:t.message,callbackURL:e.callbackURL}):e.log("passKey error",t)})),t.preventDefault()},!1)};"console"in window&&window.console.log&&window.console.log("WWPass frontend library version ".concat("2.1.2")),window.WWPass={authInit:function(t){var e,n,r=f({},{ticketURL:"",callbackURL:"",hw:!1,ppx:"wwp_",version:2,log:function(){}},t);"string"==typeof r.callbackURL&&(r.callbackURL=(e=r.callbackURL,(n=document.createElement("a")).href=e,n.href)),r.passkeyButton="string"==typeof r.passkey?document.querySelector(r.passkey):r.passkey,r.qrcode="string"==typeof r.qrcode?document.querySelector(r.qrcode):r.qrcode;var a,o=[];return r.passkeyButton&&o.push((a=r,new Promise(function(n,r){var o=f({},{ticketURL:"",callbackURL:"",ppx:"wwp_",forcePasskeyButton:!0,log:function(){}},a);if(o.passkeyButton||r({ppx:o.ppx,version:o.version,code:h.INTERNAL_ERROR,message:"Cannot find passkey element",callbackURL:o.callbackURL}),o.forcePasskeyButton||Fe())Ye(o,n,r);else{var i=o.passkeyButton.style.display;o.passkeyButton.style.display="none",new MutationObserver(function(t,e){Fe()&&(e.disconnect(),o.passkeyButton.style.display=i,Ye(o,n,r))}).observe(document.head,{childList:!0})}}).then(G,G))),o.push(Re(r)),Promise.race(o)},openWithTicket:function(e){return new Promise(function(n){var r=f({},{ticket:"",ttl:120,callbackURL:"",ppx:"wwp_",away:!0},e);if(T(r.ticket))D(r.ticket,r.ttl).then(function(t){r=f({},r,{clientKey:w(t)});var e=Q(r);r.away?window.location.href=e:n(e)});else{var t=Q(r);r.away?window.location.href=t:n(t)}})},isClientKeyTicket:T,cryptoPromise:j,copyClientNonce:function(t,e,r){return K(t).then(function(n){return U(e).then(function(t){var e=B();e.push({hash:t,key:i(n),deadline:window.Date.now()+1e3*r}),M(e)})})},updateTicket:function(e){return fetch(e,{cache:"no-store",headers:V}).then(function(t){if(!t.ok)throw Error('Error updating ticket from "'.concat(e,'": ').concat(t.statusText));return t.json()}).then(function(e){if(!e.newTicket||!e.oldTicket||!e.ttl)throw Error("Invalid response ot updateTicket: ".concat(e));var t={ticket:e.newTicket,ttl:e.ttl};return T(e.newTicket)?p({ticket:e.newTicket,clientKeyOnly:!0}).then(function(t){if(!t.clientKey)throw Error("No client key associated with the ticket ".concat(e.newTicket));return K(t.originalTicket?t.originalTicket:e.newTicket,t.ttl)}).then(function(){return t}):t})},pluginPresent:Fe,waitForRemoval:function(){return He(We,Ue)},STATUS:h}}();
//# sourceMappingURL=wwpass-frontend.min.js.map
